# DS4Windows 導入ガイド

## 目次
1. [DS4Windowsとは](#ds4windowsとは)
2. [システム要件](#システム要件)
3. [インストール手順](#インストール手順)
4. [初回セットアップ](#初回セットアップ)
5. [コントローラーの接続](#コントローラーの接続)
6. [基本的な使い方](#基本的な使い方)
7. [トラブルシューティング](#トラブルシューティング)

---

## DS4Windowsとは

DS4Windowsは、PlayStation 4/5のDualShock 4およびDualSenseコントローラーをWindows PCで使用するためのオープンソースソフトウェアです。

### 主な機能
- **Xbox 360コントローラーのエミュレーション**: Xbox対応ゲームでPS4/PS5コントローラーを使用可能
- **カスタマイズ可能なボタンマッピング**: ボタン配置を自由にカスタマイズ
- **プロファイル機能**: ゲームごとに異なる設定を保存・自動切替
- **タッチパッドのマウス操作**: タッチパッドをマウスとして使用
- **ライトバーのカスタマイズ**: 好みの色に変更可能
- **マクロ・特殊アクション**: 複雑な操作を自動化

---

## システム要件

### 最小要件
- **OS**: Windows 10 (64bit) 以降
- **.NET**: .NET 8.0 Runtime (Desktop) 以降
- **アーキテクチャ**: x64 (64bit)
- **RAM**: 2GB以上推奨
- **接続方式**: USB接続またはBluetooth 4.0以降

### 対応コントローラー
- DualShock 4 (CUH-ZCT1, CUH-ZCT2)
- DualSense (CFI-ZCT1)
- DualSense Edge

---

## インストール手順

### 1. 前提条件の確認

#### .NET 8.0 Runtimeのインストール
1. [Microsoft公式サイト](https://dotnet.microsoft.com/download/dotnet/8.0)にアクセス
2. 「.NET Desktop Runtime 8.0.x」の「x64」版をダウンロード
3. インストーラーを実行してインストール

#### Visual C++ 再頒布可能パッケージのインストール
1. [Microsoft公式サイト](https://aka.ms/vs/17/release/vc_redist.x64.exe)から最新版をダウンロード
2. インストーラーを実行してインストール

### 2. DS4Windowsのダウンロード

1. [GitHubリリースページ](https://github.com/gwin7ok/DS4Windows-Vader4Pro/releases)にアクセス
2. 最新バージョンの`DS4Windows_x.x.x_x64.zip`をダウンロード
3. ZIPファイルを任意のフォルダに解凍
   - **推奨**: `C:\Program Files\DS4Windows`
   - **注意**: 日本語を含むパスは避けてください

### 3. ドライバーのインストール

DS4Windowsを初回起動すると、必要なドライバーのインストールが求められる場合があります。

#### HidHideのインストール（推奨）
HidHideは、コントローラーの二重入力を防ぐために必要です。

1. DS4Windowsを起動
2. 「設定」→「その他」タブを開く
3. 「HidHideをインストール」ボタンをクリック
4. 指示に従ってインストール
5. PCを再起動

---

## 初回セットアップ

### 1. DS4Windowsの起動

1. 解凍したフォルダ内の`DS4Windows.exe`を実行
2. Windows Defenderの警告が表示される場合：
   - 「詳細情報」をクリック
   - 「実行」をクリック

### 2. 初期設定ウィザード

初回起動時、以下の設定を行います：

#### プロファイル保存場所の選択
- **アプリケーションフォルダ**: DS4Windowsと同じフォルダに保存（ポータブル運用向け）
- **AppDataフォルダ**: `%AppData%\DS4Windows`に保存（推奨）

#### デフォルトプロファイルの作成
- 「Default」プロファイルが自動的に作成されます
- 後から自由にカスタマイズ可能

### 3. 言語設定

1. メインウィンドウ上部の「Settings」タブをクリック
2. 「Language」ドロップダウンから「日本語」を選択
3. DS4Windowsを再起動して言語を適用

---

## コントローラーの接続

### USB接続（推奨：初回セットアップ時）

1. USBケーブルでコントローラーをPCに接続
2. DS4Windowsが自動的にコントローラーを認識
3. メイン画面の「Controllers」タブに表示される

### Bluetooth接続

#### ペアリング手順
1. **コントローラー側**:
   - DualShock 4: `PSボタン` + `SHAREボタン`を同時に3秒以上長押し
   - DualSense: `PSボタン` + `クリエイトボタン`を同時に3秒以上長押し
   - ライトバーが点滅を開始

2. **PC側**:
   - Windows設定を開く（`Win + I`）
   - 「デバイス」→「Bluetoothとその他のデバイス」
   - 「Bluetoothまたはその他のデバイスを追加する」をクリック
   - 「Bluetooth」を選択
   - 「Wireless Controller」を選択してペアリング

3. **DS4Windows側**:
   - コントローラーが自動的に認識され、「Controllers」タブに表示される

#### Bluetooth接続のトラブルシューティング
- **接続が不安定な場合**: USBで一度接続してから再度Bluetoothでペアリング
- **二重入力が発生する場合**: HidHideをインストール（上記参照）
- **遅延が気になる場合**: USB接続を推奨

---

## 基本的な使い方

### プロファイルの作成

1. 「Profiles」タブを開く
2. 「New」ボタンをクリック
3. プロファイル名を入力（例: "FPS用"、"レース用"）
4. 「Save」をクリック

### ボタンマッピングの変更

1. 変更したいプロファイルを選択
2. 「Edit」ボタンをクリック
3. プロファイルエディタが開く
4. 変更したいボタンをクリック
5. 割り当てたい機能を選択
   - **コントローラーボタン**: Xbox形式のボタン
   - **キーボード**: キーを割り当て
   - **マウス**: マウスボタン・動作を割り当て
   - **マクロ**: 複数の操作を自動実行
6. 「Save」をクリックして保存

### プロファイルの切り替え

#### 手動切り替え
1. 「Controllers」タブで対象のコントローラーを選択
2. 「Selected Profile」ドロップダウンから使用するプロファイルを選択

#### 自動切り替え（Auto Profiles）
1. 「Auto Profiles」タブを開く
2. 「Add」ボタンをクリック
3. プログラム名またはウィンドウタイトルを指定
4. 適用するプロファイルを選択
5. 「Save」をクリック

対象のアプリケーションがアクティブになると、自動的にプロファイルが切り替わります。

### ライトバーの色変更

1. プロファイルエディタを開く
2. 「Lightbar」タブを選択
3. カラーピッカーで好みの色を選択
4. バッテリー残量に応じた色変更も設定可能

### タッチパッドの設定

1. プロファイルエディタを開く
2. 「Touchpad」セクションを選択
3. 以下の設定が可能:
   - **マウスモード**: タッチパッドをマウスとして使用
   - **ボタンマッピング**: タッチパッドクリックに機能を割り当て
   - **ジェスチャー**: スワイプ操作を設定

---

## トラブルシューティング

### コントローラーが認識されない

#### 確認事項
1. **USBケーブルの確認**: データ転送対応ケーブルを使用しているか
2. **Bluetoothの確認**: Bluetooth 4.0以上に対応しているか
3. **ドライバーの確認**: デバイスマネージャーで不明なデバイスがないか確認

#### 対処方法
1. DS4Windowsを管理者権限で実行
2. Windowsを再起動
3. コントローラーをUSBで接続し、リセットボタン（背面の小さな穴）を押す
4. 最新版のDS4Windowsを使用しているか確認

### 二重入力が発生する

**症状**: ゲーム内でコントローラー入力が二重に認識される

**対処方法**:
1. HidHideをインストール（上記「ドライバーのインストール」参照）
2. DS4Windows設定の「その他」タブで「HidGuardianを有効化」をチェック
3. PCを再起動

### 入力遅延が気になる

**対処方法**:
1. USB接続を使用（Bluetoothより低遅延）
2. プロファイルエディタで「Output Curve」を「Linear」に設定
3. Windows設定で「ゲームモード」を有効化
4. 「設定」→「その他」で「UDP Server」を無効化

### ゲームでコントローラーが認識されない

**確認事項**:
1. DS4Windowsが起動しているか
2. コントローラーがDS4Windowsで認識されているか
3. プロファイルが適用されているか

**対処方法**:
1. Steamの場合: Steam設定で「PlayStation設定サポート」を**無効化**
2. ゲームを起動する前にDS4Windowsを起動
3. 「設定」→「その他」で「仮想コントローラーを隠す」を無効化

### バッテリーの持ちが悪い

**対処方法**:
1. ライトバーの明るさを下げる
2. タッチパッドを無効化
3. Bluetoothではなく必要時のみUSB接続
4. DS4Windows設定で「アイドル時の切断」を有効化

### DS4Windowsが起動しない

**対処方法**:
1. .NET 8.0 Runtimeがインストールされているか確認
2. Visual C++ 再頒布可能パッケージがインストールされているか確認
3. Windows Defenderでブロックされていないか確認
4. 管理者権限で実行
5. 設定ファイルを削除して初期化:
   - `%AppData%\DS4Windows`フォルダ内の`Profiles.xml`を削除
   - DS4Windowsを再起動

### ログの確認方法

問題が解決しない場合、ログファイルを確認してください:

1. DS4Windowsインストールフォルダの`Logs`フォルダを開く
   - AppData使用時: `%AppData%\DS4Windows\Logs`
2. 最新の`ds4windows_log_YYYYMMDD.txt`を開く
3. エラーメッセージを確認

---

## 高度な機能

### 特殊アクション（Special Actions）

複雑な操作を自動化できます:

1. プロファイルエディタの「Special Actions」タブを開く
2. 「Add」をクリック
3. アクションの種類を選択:
   - **プロファイル切り替え**: 特定のボタンでプロファイルを切替
   - **マクロ**: 複数の入力を連続実行
   - **プログラム起動**: ボタンでアプリケーションを起動
   - **Bluetooth切断**: コントローラーをBluetooth切断

### マクロの作成

1. 「Special Actions」で「Macro」を選択
2. 記録したい操作を設定:
   - キー/ボタンの順序
   - 各操作の待機時間
3. トリガーとなるボタンを設定

### 複数コントローラーの管理

DS4Windowsは最大4台のコントローラーを同時に管理できます:

1. 「Controllers」タブで各コントローラーを確認
2. それぞれ異なるプロファイルを割り当て可能
3. 「Linked Profile」でコントローラーごとの固定プロファイルを設定

---

## よくある質問（FAQ）

### Q1: DS4Windowsは無料ですか？
**A**: はい、完全に無料でオープンソースです。

### Q2: DualSenseの特殊機能（アダプティブトリガーなど）は使えますか？
**A**: 基本的な入力は可能ですが、アダプティブトリガーやハプティックフィードバックは完全には対応していません。

### Q3: ゲームごとに自動でプロファイルを切り替えたい
**A**: 「Auto Profiles」機能を使用してください（上記「自動切り替え」参照）。

### Q4: コントローラーを複数台使いたい
**A**: 最大4台まで同時接続可能です。各コントローラーに異なるプロファイルを割り当てられます。

### Q5: DS4Windowsを自動起動したい
**A**: 
1. DS4Windowsのショートカットを作成
2. `Win + R`で`shell:startup`を実行
3. スタートアップフォルダにショートカットを配置

### Q6: バッテリー残量を確認したい
**A**: メイン画面の「Controllers」タブに表示されます。ライトバーの色で残量を表示する設定も可能です。

---

## サポート・コミュニティ

### 公式リソース
- **GitHub**: https://github.com/gwin7ok/DS4Windows-Vader4Pro
- **Issue報告**: https://github.com/gwin7ok/DS4Windows-Vader4Pro/issues
- **Wiki**: https://github.com/gwin7ok/DS4Windows-Vader4Pro/wiki

### 問題報告時の情報
以下の情報を添えると解決が早くなります:
- DS4Windowsのバージョン
- Windowsのバージョン
- コントローラーのモデル
- 接続方式（USB/Bluetooth）
- エラーメッセージ（ログファイルの内容）

---

## ライセンス

DS4Windowsは[GNU General Public License v3.0](https://www.gnu.org/licenses/gpl-3.0.html)の下で配布されています。

---

**更新日**: 2025年12月10日  
**対応バージョン**: DS4Windows v3.11.5以降
